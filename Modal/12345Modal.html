<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>

</head>
<style>
    #backBtnclass {
        position: absolute;
        top: 3.333rem;
        right: 1.667rem;
        color: #fff;
        font-size: 1.167rem;
        cursor: pointer;
        display: none;
    }

    #rotate {
        height: 26rem;
        width: 37.5rem;
        padding: .2rem;
        position: relative;
        margin: 0.833rem auto;
        top: -1rem;
    }

    #rotate a {
        position: absolute;
        top: 0px;
        left: 0px;
        color: #04FDF5;
        font-weight: bold;
        padding: 0.25rem 0.5rem;
        font-size: .8rem;

    }

    #rotate a:hover {
        border: 1px solid #eee;
        background: #000;
        border-radius: 0.417rem;
    }
</style>
<link rel="stylesheet" type="text/css" href="../css/12345Modal.css"/>
<link rel="stylesheet" type="text/css" href="../css/pubilic.css"/>
<script src="https://webapi.amap.com/maps?v=1.4.15&key=dfaffd18975f1df62f36d3a189acbae2&plugin=AMap.DistrictSearch,AMap.Scale"></script>
<script src="https://a.amap.com/jsapi_demos/static/demo-center/js/demoutils.js"></script>
<script>
    let LastHeatmMapData = [
        {
            name: '安亭镇',
            lng: 121.164061,
            lat: 31.294312,
            count: ""
        }, {
            name: '马陆镇',
            lng: 121.283332,
            lat: 31.333119,
            count: ""
        }, {
            name: '南翔镇',
            lng: 121.320331,
            lat: 31.294436,
            count: ""
        }, {
            name: '江桥镇',
            lng: 121.331696,
            lat: 31.238858,
            count: ""
        }, {
            name: '徐行镇',
            lng: 121.280687,
            lat: 31.416167,
            count: ""
        }, {
            name: '外冈镇',
            lng: 121.162302,
            lat: 31.362788,
            count: ""
        }, {
            name: '华亭镇',
            lng: 121.242686,
            lat: 31.468279,
            count: ""
        }, {
            name: '新成路街道',
            lng: 121.269643,
            lat: 31.386835,
            count: ""
        }, {
            name: '嘉定镇',
            lng: 121.239343,
            lat: 31.372602,
            count: ""
        }, {
            name: '真新街道',
            lng: 121.360212,
            lat: 31.244405,
            count: ""
        }, {
            name: '工业区',
            lng: 121.206181,
            lat: 31.417779,
            count: ""
        }, {
            name: '菊园新区管委会',
            lng: 121.245581,
            lat: 31.392629,
            count: ""
        },
    ]
    let heatmapData = [
        {
            "lng": 121.26710,
            "lat": 31.47022,
            "count": 10
        }

    ]


</script>
<body>
<div class="Modal-warp">
    <div id="clearid">x</div>
    <div class="Modal-left">
        <div>
            <div class="Modal-left-header">
                12345市民服务热线
            </div>
            <div class="Modal-left-item">
                <div class="FX_header" style="padding: 0rem 1.667rem">
                    <div class="header">
                        <a class="line"></a>
                        <span>统计分析</span>
                        <a class="line1"></a>
                    </div>
                    <div id="dropdown">
                        <p style="border:1px solid #1DD6DF;color: #1DD6DF">今月</p>
                        <ul style="border:1px solid #1DD6DF;color: #1DD6DF">
                            <li><a href="#" rel="1" onclick="dropdownFun('日')"> 今日</a></li>
                            <li><a href="#" rel="2" onclick="dropdownFun('月')">本月</a></li>
                            <li><a href="#" rel="3" onclick="dropdownFun('年')">今年</a></li>
                        </ul>
                    </div>
                </div>

                <div class="Satisfaction-warp">
                    <div class="Satisfaction-warp-item">
                        <div class="Satisfaction-warp-item-header">
                            <div class="Satisfaction-warp-item-header-left">
                                <div class="banner1" onclick="TabsFun(1)">基本情况</div>
                            </div>
                            <div id="dropdown1">
                                <p>问题类型</p>
                                <ul>
                                    <li><a href="#" rel="1">问题来源</a></li>
                                    <li><a href="#" rel="2">问题类型</a></li>
                                    <li><a href="#" rel="3">诉求情况</a></li>
                                </ul>
                            </div>
                        </div>
                        <div class="Satisfaction-warp-item-echarts">
                            <div id="SmallECharts3" class="SmallECharts3"
                                 style="width: 47.917rem;height:29.167rem;margin-right: 1.667rem;padding-top:-3.333rem"></div>
                            <div id="SmallECharts3copy" class="SmallECharts3copy"
                                 style="width: 47.917rem;height:29.167rem;margin-right: 1.667rem;padding-top:-3.333rem"></div>
                            <div id="backBtnclass" onclick="backBtn()">返回上一级</div>
                        </div>
                    </div>
                    <div class="Satisfaction-warp-item">
                        <div class="Satisfaction-warp-item-header">
                            <div class="Satisfaction-warp-item-header-left">
                                <div class="banner1">热词</div>
                            </div>
                        </div>
                        <div class="Satisfaction-warp-item-echarts">
                            <div id="rotate">
                                <a  target="_blank">春暖花开</a>
                                <a  target="_blank">珠光宝气</a>
                                <a  target="_blank">网游试玩</a>
                                <a  target="_blank">短信表白</a>
                                <a  target="_blank">卡片设计</a>
                                <a  target="_blank">网页计</a>
                                <a  target="_blank">SEO化</a>
                                <a  target="_blank">外语翻译</a>
                                <a  target="_blank">推广</a>   <a  target="_blank">春暖花开</a>
                                <a  target="_blank">珠光宝气</a>
                                <a  target="_blank">网游试玩</a>
                                <a  target="_blank">短信表白</a>
                                <a  target="_blank">卡片设计</a>
                                <a  target="_blank">网页计</a>
                                <a  target="_blank">SEO化</a>
                                <a  target="_blank">外语翻译</a>
                                <a  target="_blank">推广</a>   <a  target="_blank">春暖花开</a>
                                <a  target="_blank">珠光宝气</a>
                                <a  target="_blank">网游试玩</a>
                                <a  target="_blank">短信表白</a>
                                <a  target="_blank">卡片设计</a>
                                <a  target="_blank">网页计</a>
                                <a  target="_blank">SEO化</a>
                                <a  target="_blank">外语翻译</a>
                                <a  target="_blank">推广</a>   <a  target="_blank">春暖花开</a>
                                <a  target="_blank">珠光宝气</a>
                                <a  target="_blank">网游试玩</a>
                                <a  target="_blank">短信表白</a>
                                <a  target="_blank">卡片设计</a>
                                <a  target="_blank">网页计</a>
                                <a  target="_blank">SEO化</a>
                                <a  target="_blank">外语翻译</a>
                                <a  target="_blank">推广</a>   <a  target="_blank">春暖花开</a>
                                <a  target="_blank">珠光宝气</a>
                                <a  target="_blank">网游试玩</a>
                                <a  target="_blank">短信表白</a>
                                <a  target="_blank">卡片设计</a>
                                <a  target="_blank">网页计</a>
                                <a  target="_blank">SEO化</a>
                                <a  target="_blank">外语翻译</a>
                                <a  target="_blank">推广</a>   <a  target="_blank">春暖花开</a>
                                <a  target="_blank">珠光宝气</a>
                                <a  target="_blank">网游试玩</a>
                                <a  target="_blank">短信表白</a>
                                <a  target="_blank">卡片设计</a>
                                <a  target="_blank">网页计</a>
                                <a  target="_blank">SEO化</a>
                                <a  target="_blank">外语翻译</a>
                                <a  target="_blank">推广</a>

                            </div>
<!--                            <div id="SmallECharts4"-->
<!--                                 style="width: 47.917rem;height:29.167rem;margin-right: 1.667rem;padding-top: -3.333rem;">-->
<!--                            </div>-->
                        </div>
                    </div>
                </div>
            </div>
            <div class="Modal-left-item">

                <div class="Satisfaction-warp">
                    <div class="Satisfaction-warp-item">
                        <div class="header">
                            <a class="line"></a>
                            <span>满意度评价</span>
                            <a class="line1"></a>
                        </div>
                        <div class="Satisfaction-warp-item-header">
                            <div class="Satisfaction-warp-item-header-left">
                                <div class="banner1" onclick="TabsFun(3)">街镇</div>
                                <div class="banner2" onclick="TabsFun(4)">委办局</div>
                                <div class="banner2" onclick="TabsFun(5)">公司</div>
                            </div>

                        </div>
                        <div class="Satisfaction-warp-item-echarts">
                            <div id="SmallECharts"
                                 style="width: 47.5rem;height:21.667rem;position: absolute;left: 1.667rem;top: 2.5rem"></div>
                        </div>
                    </div>
                    <div class="Satisfaction-warp-item">
                        <div class="header">
                            <a class="line"></a>
                            <span>重点工单提示</span>
                            <a class="line1"></a>
                        </div>
                        <div class="Satisfaction-warp-item-header">
                            <div class="Satisfaction-warp-item-header-left">
                                <div class="banner1" onclick="TabsFun(6)">紧急工单</div>
                                <div class="banner2" onclick="TabsFun(7)">重复工单</div>
                                <div class="banner2" onclick="TabsFun(8)">反复退单</div>
                            </div>
                        </div>
                        <div class="Satisfaction-warp-item-echarts">

                            <ul class="Workorder " id="WorkorderID">
                                <div class="work-older-list">
                                    <div id="GongDanTitleID"></div>
                                    <div id="GongDanIDBox" style="height: 200px;overflow: hidden">
                                        <div id="GongDanID"></div>
                                        <div id="GongDanIDCopy"></div>
                                    </div>
                                </div>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>


        </div>
    </div>
    <div class="Modal-right" id="mapContainer">
        <div class="Modal-right-title">嘉定区12345事件热力图</div>
    </div>
</div>
</body>
<script type="text/javascript" src="../js/commonJs.js"></script>
<script src="../js/echarts.min.js" type="text/javascript" charset="utf-8"></script>
<script src="../js/MyEcharts.js" type="text/javascript" charset="utf-8"></script>
<script type="text/javascript" src="Js/12345map.js"></script>

<script type="text/javascript" src="Js/ajaxPromise.js"></script>
<script type="text/javascript" src="Js/unit.js"></script>
<script type="text/javascript" src="../js/jquery-3.4.1.min.js"></script>
<script>
    var ModelTime = "月"
    document.getElementById("clearid").onclick = function () {
        window.parent.document.getElementById("ModalBox").style.display = "none";
    }
    $("#dropdown1 p").click(function () {
        $("#dropdown2 ul").hide();
        $("#dropdown ul").hide();
        var ul = $("#dropdown1 ul");
        if (ul.css("display") == "none") {
            ul.slideDown("fast");
        } else {
            ul.slideUp("fast");
        }
        $("#dropdown1 ul li a").click(function () {

            var txt = $(this).text();
            $("#dropdown1 p").html(txt);
            var value = $(this).attr("rel");
            $("#dropdown1 ul").hide();

            $("#result").html("您选择了" + txt + "，值为：" + value);
        });
    })
    $("#dropdown2 p").click(function () {
        $("#dropdown1 ul").hide();
        $("#dropdown ul").hide();
        var ul = $("#dropdown2 ul");
        if (ul.css("display") == "none") {
            ul.slideDown("fast");
        } else {
            ul.slideUp("fast");
        }
        $("#dropdown2 ul li a").click(function () {

            var txt = $(this).text();
            $("#dropdown2 p").html(txt);
            var value = $(this).attr("rel");

            $("#dropdown2 ul").hide();
            $("#result").html("您选择了" + txt + "，值为：" + value);
        });
    })
    $("#dropdown p").click(function () {
        $("#dropdown1 ul").hide();
        $("#dropdown2 ul").hide();
        var ul = $("#dropdown ul");
        if (ul.css("display") == "none") {
            ul.slideDown("fast");
        } else {
            ul.slideUp("fast");
        }
        $("#dropdown ul li a").click(function () {
            var txt = $(this).text();
            $("#dropdown p").html(txt);
            var value = $(this).attr("rel");
            $("#dropdown ul").hide();
            $("#result").html("您选择了" + txt + "，值为：" + value);

        });
    })

    function dropdownFun(value) {
        console.log('++++++++++++++++++++++++++++++++++++++')

        ModelTime = value
        ToOnload()
    }

    window.onload = function () {
        // MyEcharts.initChart(MyEcharts.EchartsOption.newbar(), "SmallECharts")
        ToOnload()
        canvaslineFun()
        rotateFun()
    }

    var radius = 100;
    var dtr = Math.PI / 200;
    var d = 300;

    var mcList = [];
    var active = false;
    var lasta = 1;
    var lastb = 1;
    var distr = true;
    var tspeed = 2;
    var size = 250;

    var mouseX = 0;
    var mouseY = 0;

    var howElliptical = 1;

    var aA = null;
    var oDiv = null;

 function   rotateFun() {
        var i = 0;
        var oTag = null;

        oDiv = document.getElementById('rotate');

        aA = oDiv.getElementsByTagName('a');

        for (i = 0; i < aA.length; i++) {
            oTag = {};

            oTag.offsetWidth = aA[i].offsetWidth;
            oTag.offsetHeight = aA[i].offsetHeight;

            mcList.push(oTag);
        }

        sineCosine(0, 0, 0);

        positionAll();
        oDiv.onmouseover = function () {
            active = false;
        };
        oDiv.onmouseout = function () {
            active = true;
        };

        oDiv.onmousemove = function (ev) {
            var oEvent = window.event || ev;

            mouseX = oEvent.clientX - (oDiv.offsetLeft + oDiv.offsetWidth / 2);
            mouseY = oEvent.clientY - (oDiv.offsetTop + oDiv.offsetHeight / 2);

            mouseX /= 5;
            mouseY /= 5;
        };

        setInterval(update, 60);
    };

    function update() {
        var a;
        var b;

        if (active) {
            a = (-Math.min(Math.max(-mouseY, -size), size) / radius) * tspeed;
            b = (Math.min(Math.max(-mouseX, -size), size) / radius) * tspeed;
        } else {
            a = lasta * 0.98;
            b = lastb * 0.98;
        }

        lasta = a;
        lastb = b;

        if (Math.abs(a) <= 0.01 && Math.abs(b) <= 0.01) {
            return;
        }

        var c = 0;
        sineCosine(a, b, c);
        for (var j = 0; j < mcList.length; j++) {
            var rx1 = mcList[j].cx;
            var ry1 = mcList[j].cy * ca + mcList[j].cz * (-sa);
            var rz1 = mcList[j].cy * sa + mcList[j].cz * ca;

            var rx2 = rx1 * cb + rz1 * sb;
            var ry2 = ry1;
            var rz2 = rx1 * (-sb) + rz1 * cb;

            var rx3 = rx2 * cc + ry2 * (-sc);
            var ry3 = rx2 * sc + ry2 * cc;
            var rz3 = rz2;

            mcList[j].cx = rx3;
            mcList[j].cy = ry3;
            mcList[j].cz = rz3;

            per = d / (d + rz3);

            mcList[j].x = (howElliptical * rx3 * per) - (howElliptical * 2);
            mcList[j].y = ry3 * per;
            mcList[j].scale = per;
            mcList[j].alpha = per;

            mcList[j].alpha = (mcList[j].alpha - 0.6) * (10 / 6);
        }

        doPosition();
        depthSort();
    }

    function depthSort() {
        var i = 0;
        var aTmp = [];

        for (i = 0; i < aA.length; i++) {
            aTmp.push(aA[i]);
        }

        aTmp.sort
        (
            function (vItem1, vItem2) {
                if (vItem1.cz > vItem2.cz) {
                    return -1;
                } else if (vItem1.cz < vItem2.cz) {
                    return 1;
                } else {
                    return 0;
                }
            }
        );

        for (i = 0; i < aTmp.length; i++) {
            aTmp[i].style.zIndex = i;
        }
    }

    function positionAll() {
        var phi = 0;
        var theta = 0;
        var max = mcList.length;
        var i = 0;

        var aTmp = [];
        var oFragment = document.createDocumentFragment();


        for (i = 0; i < aA.length; i++) {
            aTmp.push(aA[i]);
        }

        aTmp.sort
        (
            function () {
                return Math.random() < 0.5 ? 1 : -1;
            }
        );

        for (i = 0; i < aTmp.length; i++) {
            oFragment.appendChild(aTmp[i]);
        }

        oDiv.appendChild(oFragment);

        for (var i = 1; i < max + 1; i++) {
            if (distr) {
                phi = Math.acos(-1 + (2 * i - 1) / max);
                theta = Math.sqrt(max * Math.PI) * phi;
            } else {
                phi = Math.random() * (Math.PI);
                theta = Math.random() * (2 * Math.PI);
            }

            mcList[i - 1].cx = radius * Math.cos(theta) * Math.sin(phi);
            mcList[i - 1].cy = radius * Math.sin(theta) * Math.sin(phi);
            mcList[i - 1].cz = radius * Math.cos(phi);

            aA[i - 1].style.left = mcList[i - 1].cx + oDiv.offsetWidth / 2 - mcList[i - 1].offsetWidth / 2 + 'px';
            aA[i - 1].style.top = mcList[i - 1].cy + oDiv.offsetHeight / 2 - mcList[i - 1].offsetHeight / 2 + 'px';
        }
    }

    function doPosition() {
        var l = oDiv.offsetWidth / 2;
        var t = oDiv.offsetHeight / 2;
        for (var i = 0; i < mcList.length; i++) {
            aA[i].style.left = mcList[i].cx + l - mcList[i].offsetWidth / 2 + 'px';
            aA[i].style.top = mcList[i].cy + t - mcList[i].offsetHeight / 2 + 'px';

            aA[i].style.fontSize = Math.ceil(12 * mcList[i].scale / 2) + 8 + 'px';

            aA[i].style.filter = "alpha(opacity=" + 100 * mcList[i].alpha + ")";
            aA[i].style.opacity = mcList[i].alpha;
        }
    }

    function sineCosine(a, b, c) {
        sa = Math.sin(a * dtr);
        ca = Math.cos(a * dtr);
        sb = Math.sin(b * dtr);
        cb = Math.cos(b * dtr);
        sc = Math.sin(c * dtr);
        cc = Math.cos(c * dtr);
    }
</script>
</html>